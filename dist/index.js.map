{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/cache.js","webpack:///./src/fetch.js","webpack:///./src/helpers/wrapFor.js","webpack:///./src/include/index.js","webpack:///./src/index.js","webpack:///./src/prefetch.js","webpack:///./src/promiseTree.js","webpack:///./src/transform/pre/alias.js","webpack:///./src/transform/pre/defineSourceProp.js","webpack:///./src/transform/pre/index.js","webpack:///./src/transform/pre/rootMembers.js","webpack:///./src/transform/resourceProps.js","webpack:///external \"babel-runtime/core-js/object/assign\"","webpack:///external \"babel-runtime/core-js/object/define-property\"","webpack:///external \"babel-runtime/core-js/object/keys\"","webpack:///external \"babel-runtime/core-js/object/values\"","webpack:///external \"babel-runtime/core-js/promise\"","webpack:///external \"lodash/defaults\"","webpack:///external \"lodash/get\"","webpack:///external \"lodash/merge\"","webpack:///external \"lodash/omit\"","webpack:///external \"lodash/pick\"","webpack:///external \"lodash/set\"","webpack:///external \"lodash/setWith\""],"names":["IndexedCache","constructor","Object","defineProperty","enumerable","value","keys","_cache","set","path","get","LinkedIndexedCache","indexedCache","TypeError","split","base","slice","prop","length","target","configurable","_linked","data","type","id","_extractCache","reduce","array","values","concat","fetch","queries","action","options","args","resourceCache","dataCache","includedCache","included","include","createIncludeDict","dict","pop","console","log","dir","depth","includePromiseTree","run","forSingleOrMany","forMany","f","Array","isArray","map","call","apply","arguments","query","JsonApi","_connected","connect","_createTypeError","_fetch","Function","forEach","key","_wrappedPreTransform","prefetch","_transformTreePath","push","_createNode","then","_createPromiseTree","paths","rootNode","result","_runPromiseTree","node","rejected","all","error","PromiseTree","tree","promiseTree","_tree","assignAlias","alias","fullPath","obj","_omitProps","_alias","aliased","source","preTransform","merge","defaults","attributes","fields","rootAttributes","RESOURCE_IDENTIFIER_PROPS","ADDITIONAL_RESOURCE_PROPS","RESOURCE_PROPS"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading wasm modules\n \tvar installedWasmModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// object with all compiled WebAssembly.Modules\n \t__webpack_require__.w = {};\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","import get from 'lodash/get'\nimport set from 'lodash/setWith'\n\nexport class IndexedCache {\n  constructor() {\n    Object.defineProperty(this, '_cache', {\n      enumerable: true,\n      value: {}\n    })\n  }\n\n  get keys() {\n    return Object.keys(this._cache)\n  }\n\n  set(path, value) {\n    set(this._cache, path, value, Object)\n\n    return this\n  }\n\n  get(path) {\n    return get(this._cache, path)\n  }\n}\n\nexport class LinkedIndexedCache extends IndexedCache {\n  constructor(indexedCache) {\n    super()\n\n    if(!indexedCache instanceof IndexedCache) {\n      throw TypeError('First arguments should be an instance of IndexedCache')\n    }\n\n    Object.defineProperty(this, '_linked', {\n      // enumerable: true,\n      value: indexedCache\n    })\n  }\n\n  set(path, value) {\n    if(typeof path === 'string') {\n      path = path.split('.')\n    }\n\n    const base = path.slice(0, -1)\n\n    const prop = path[path.length - 1]\n    let target\n\n    if (base.length) {\n      target = get(this._cache, base)\n\n      if(!target) {\n        target = {}\n        set(this._cache, base, target, Object)\n      }\n    } else {\n      target = this._cache\n    }\n\n    Object.defineProperty(target, prop, {\n      enumerable: true,\n      configurable: true,\n      set: value => {\n        this._linked.set(path, value)\n      },\n      get: () => this._linked.get(path)\n    })\n\n    target[prop] = value\n  }\n}\n","import {\n  IndexedCache,\n  LinkedIndexedCache\n} from './cache'\nimport PromiseTree from './promiseTree'\nimport preFetch from './prefetch'\n\nimport {\n  forSingleOrMany\n} from './helpers/wrapFor'\nconst _cache = forSingleOrMany((data, indexedCache) => {\n  indexedCache.set([data.type, data.id], data)\n})\nconst _extractCache = indexedCache => {\n  return indexedCache.keys.reduce((array, type) => {\n    const values = Object.values(indexedCache.get(type))\n    return array.concat(values)\n  }, [])\n}\n\nexport default async function fetch(queries, action, type, options, ...args) {\n  const resourceCache = new IndexedCache()\n  const dataCache = new LinkedIndexedCache(resourceCache)\n  const includedCache = new LinkedIndexedCache(resourceCache)\n\n  let {\n    data,\n    included\n  } = await preFetch(queries[type][action], options[type], ...args)\n\n  _cache(data, dataCache)\n  _cache(included, includedCache)\n\n  if (options[type].include) {\n    function createIncludeDict(include) {\n      return include.reduce((dict, path) => {\n        const type = path.split('.').pop()\n\n        dict[path] = async () => {\n          const {\n            data,\n            included\n          } = await preFetch(queries[type][action], options[type], ...args)\n\n          console.log(0)\n          console.dir(resourceCache, { depth: 10 })\n          _cache(data, includedCache)\n          console.log(1, resourceCache)\n          _cache(included, includedCache)\n          console.log(2, resourceCache)\n\n\n          console.log(includedCache)\n\n          return includedCache\n        }\n\n        return dict\n      }, {})\n    }\n\n    const dict = createIncludeDict(options[type].include)\n\n    const includePromiseTree = new PromiseTree(dict)\n\n    await includePromiseTree.run()\n  }\n\n  included = _extractCache(includedCache)\n\n  return {\n    data,\n    included\n  }\n}\n","export function forSingleOrMany(f) {\n  return function(data, ...args) {\n    if (Array.isArray(data)) {\n      return data.map(data => f.call(this, data, ...args))\n    } else if (typeof data == 'object') {\n      return f.apply(this, arguments)\n    }\n    return data\n  }\n}\n\nexport function forMany(f) {\n  return function(...args) {\n    const data = args[0]\n    if (Array.isArray(data)) {\n      return f.apply(this, args)\n    }\n    return data\n  }\n}\n","import pick from 'lodash/pick'\n\nimport applyAlias from '../transform/pre/alias'\nimport prefetch from '../prefetch'\n\nconst include = (query, type, options) => {\n\n}\n","import get from 'lodash/get'\nimport set from 'lodash/set'\n\nimport preFetch from './prefetch'\nimport include from './include'\nimport fetch from './fetch'\n\nclass JsonApi {\n  constructor(options = {}) {\n    this.options = {}\n    this._connected = {}\n  }\n\n  connect(type, fetch) {\n    const keys = [\n      'create',\n      'read',\n      'update',\n      'delete'\n    ]\n    const _createTypeError = () => new TypeError('Invalid argument type for fetch')\n    const _fetch = {}\n    if (fetch instanceof Function) {\n      keys.forEach(key => _fetch[key] = fetch)\n    } else if (fetch instanceof Object) {\n      keys.forEach(key => {\n        if (!_fetch[key] instanceof Function) {\n          throw _createTypeError()\n        }\n        _fetch[key] = fetch[key]\n      })\n    } else {\n      throw _createTypeError()\n    }\n\n    this._connected[type] = _fetch\n  }\n\n  fetch(action, type, options, ...args) {\n    return fetch(this._connected, action, type, options, ...args)\n  }\n}\n\nexport default JsonApi\n","import preTransform from './transform/pre'\n\nimport { forSingleOrMany } from './helpers/wrapFor'\n\nconst _wrappedPreTransform = forSingleOrMany(preTransform)\n\nexport default async function prefetch(query, options, ...args) {\n  let {\n    data,\n    included\n  } = await query(options, ...args)\n\n  data = _wrappedPreTransform(data, options)\n\n  return {\n    data,\n    included\n  }\n}\n","import set from 'lodash/set'\n\nfunction _transformTreePath(path) {\n  let split\n\n  if(Array.isArray(path)) {\n    split = path\n  } else if(typeof path == 'string') {\n    split = path.split('.')\n  } else {\n    throw TypeError('Path should be a string or array')\n  }\n\n  return split.slice(0, -1).reduce((split, key) => {\n    split.push(key)\n    split.push('then')\n    return split\n  }, []).concat(split.slice(-1))\n}\n\nfunction _createNode(run, then) {\n  return {\n    run,\n    then\n  }\n}\n\nfunction _createPromiseTree(paths) {\n  const then = {}\n\n  for (let path in paths) {\n    set(then, _transformTreePath(path), _createNode(paths[path], null))\n  }\n\n  const rootNode = _createNode(result => result, then)\n\n  return rootNode\n}\n\nasync function _runPromiseTree(result, node, rootNode = node) {\n  if(rootNode.rejected) {\n    throw 'cancelled'\n  }\n\n  try {\n    if (node) {\n      result = await node.run(await result)\n\n      if (node.then) {\n        const keys = Object.keys(node.then)\n\n        await Promise.all(keys.map(key => _runPromiseTree(result, node.then[key], rootNode)))\n      }\n\n      return result\n    }\n  } catch(error) {\n    node.rejected = true\n    throw error\n  }\n}\n\nexport default class PromiseTree {\n  constructor(paths) {\n    const tree = _createPromiseTree(paths)\n\n    Object.defineProperty(this, '_tree', {\n      value: tree\n    })\n  }\n\n  static run(paths, data) {\n    const promiseTree = new PromiseTree(paths)\n    return promiseTree.run(data)\n  }\n\n  run(data) {\n    return _runPromiseTree(data, this._tree)\n  }\n}\n","import omit from 'lodash/omit'\nimport set from 'lodash/set'\nimport get from 'lodash/get'\n\nfunction assignAlias(data, alias, fullPath) {\n  if (typeof alias == 'string') {\n    return alias.length ? get(data, alias) : data\n  } else {\n    let obj = Array.isArray(alias) ? [] : Object.assign({}, data)\n\n    if (typeof alias == 'object') {\n      const _omitProps = []\n\n      for (let key in alias) {\n        const path = fullPath + key\n\n        let _alias = alias[key]\n\n        const aliased = assignAlias(data, _alias, path)\n\n        if (path != _alias) {\n          _omitProps.push(_alias)\n        }\n\n        set(obj, key, aliased)\n      }\n\n      if(_omitProps.length) {\n        obj = omit(obj, _omitProps)\n      }\n    }\n\n    return obj\n  }\n}\n\nexport default (data, options) => assignAlias(data, options, '')\n","export default (data, source) => {\n  Object.defineProperty(data, '_source', {\n    value: source\n  })\n}\n","import merge from 'lodash/merge'\nimport pick from 'lodash/pick'\nimport omit from 'lodash/omit'\nimport defaults from 'lodash/defaults'\n\nimport assignAlias from './alias'\nimport rootMembers from './rootMembers'\nimport assignSource from './defineSourceProp'\n\nconst preTransform = (data, options) => {\n  let source = data\n\n  if ('alias' in options) {\n    data = assignAlias(data, options.alias)\n  }\n\n  data = rootMembers(data)\n\n  if ('merge' in options) {\n    data = merge(data, options.merge)\n  }\n\n  if ('defaults' in options) {\n    defaults(data, options.defaults)\n  }\n\n  if ('fields' in options) {\n    data.attributes = omit(data.attributes, options.fields)\n  }\n\n  assignSource(data, source)\n\n  return data\n}\n\nexport default preTransform\n","import omit from 'lodash/omit'\nimport pick from 'lodash/pick'\nimport defaults from 'lodash/defaults'\n\nimport {\n  RESOURCE_PROPS\n} from '../resourceProps'\n\nexport default data => {\n  const rootAttributes = omit(data, RESOURCE_PROPS)\n\n  if (Object.keys(rootAttributes)) {\n    defaults(data, {\n      attributes: rootAttributes\n    })\n  }\n\n  data = pick(data, RESOURCE_PROPS)\n\n  return data\n}\n","export const RESOURCE_IDENTIFIER_PROPS = ['id', 'type', 'meta']\nexport const ADDITIONAL_RESOURCE_PROPS = ['attributes', 'relationships', 'links']\nexport const RESOURCE_PROPS = [\n  ...RESOURCE_IDENTIFIER_PROPS,\n  ...ADDITIONAL_RESOURCE_PROPS\n]\n","module.exports = require(\"babel-runtime/core-js/object/assign\");","module.exports = require(\"babel-runtime/core-js/object/define-property\");","module.exports = require(\"babel-runtime/core-js/object/keys\");","module.exports = require(\"babel-runtime/core-js/object/values\");","module.exports = require(\"babel-runtime/core-js/promise\");","module.exports = require(\"lodash/defaults\");","module.exports = require(\"lodash/get\");","module.exports = require(\"lodash/merge\");","module.exports = require(\"lodash/omit\");","module.exports = require(\"lodash/pick\");","module.exports = require(\"lodash/set\");","module.exports = require(\"lodash/setWith\");"],"sourceRoot":""}