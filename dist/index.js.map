{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/collection/id.js","webpack:///./src/collection/index.js","webpack:///./src/fetch.js","webpack:///./src/helpers/compareResourceIds.js","webpack:///./src/index.js","webpack:///./src/promiseTree.js","webpack:///./src/resource/id.js","webpack:///./src/resource/index.js","webpack:///./src/transform/fields.js","webpack:///./src/transform/post/index.js","webpack:///./src/transform/post/sort.js","webpack:///./src/transform/pre/alias.js","webpack:///./src/transform/pre/index.js","webpack:///./src/transform/resourceProps.js","webpack:///./src/typeStore.js","webpack:///external \"avl\"","webpack:///external \"babel-runtime/core-js/array/from\"","webpack:///external \"babel-runtime/core-js/object/assign\"","webpack:///external \"babel-runtime/core-js/object/define-properties\"","webpack:///external \"babel-runtime/core-js/promise\"","webpack:///external \"babel-runtime/core-js/set\"","webpack:///external \"lodash/defaults\"","webpack:///external \"lodash/get\"","webpack:///external \"lodash/isEmpty\"","webpack:///external \"lodash/isNil\"","webpack:///external \"lodash/isObject\"","webpack:///external \"lodash/merge\"","webpack:///external \"lodash/omit\"","webpack:///external \"lodash/once\"","webpack:///external \"lodash/pick\"","webpack:///external \"lodash/set\""],"names":["ResourceIdCollection","constructor","source","options","value","Avl","compareResourceIds","writable","ResourceConstructor","arguments","length","Array","isArray","forEach","resource","collection","has","add","count","_empty","_array","isEmpty","_nullable","_avl","keys","values","entries","node","push","key","data","id","insert","update","_include","included","_included","type","ResourceCollection","ResourceObject","prototype","apply","call","toJSON","toJSONed","map","createQueryIds","_s","ResourceIdentifier","_i","ids","_ids","fetch","queries","action","args","typeStore","TypeStore","_fetch","typeOptions","query","prefetched","result","tree","PromiseTree","includedTree","set","opts","next","include","path","parse","index","slice","filter","r","resolve","console","dir","depth","Infinity","compare","a","b","Resource","JsonApi","_connected","connect","_createTypeError","TypeError","Function","Object","_resolveChildren","rootNode","child","all","children","_resolve","rejected","then","resolved","catch","error","Node","ResourceId","_resource","from","ResourceID","_attrs","_r","fields","relationships","get","pick","RESOURCE_PROPS","_a","attributes","posttransform","sort","_sortByNumberOrCharCodes","vector","_sortByKey","rule","_parseSortRules","string","split","applySort","res","assignAlias","alias","fullPath","obj","_omitProps","_alias","aliased","pretransform","isOptionsPassed","defaults","merge","RESOURCE_IDENTIFIER_ESSENTIAL_PROPS","reduce","links","RESOURCE_OPTIONAL_PROPS","RESOURCE_IDENTIFIER_PROPS","RESOURCE_OBJECT_OPTIONAL_PROPS","single","defineProperty"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","import Avl from 'avl'\nimport get from 'lodash/get'\n\nimport ResourceId from '../resource/id'\nimport compareResourceIds from '../helpers/compareResourceIds'\n\nclass ResourceIdCollection {\n  constructor(source, options) {\n    Object.defineProperties(this, {\n      '_avl': {\n        value: new Avl(compareResourceIds, true)\n      },\n      '_array': {\n        writable: true,\n        value: false\n      },\n      '_empty': {\n        writable: true,\n        value: true\n      }\n    })\n\n    const ResourceConstructor = this.ResourceConstructor\n\n    if(arguments.length) {\n      if (Array.isArray(source)) {\n        source.forEach(source => {\n          const resource = new ResourceConstructor(source, options)\n\n          if (!collection.has(resource)) {\n            this.add(resource)\n          }\n        })\n\n        if (collection.count()) {\n          this._empty = false\n        }\n        this._array = true\n      } else {\n        const resource = new ResourceConstructor(source, options)\n        this.add(resource)\n        this._array = false\n        this._empty = false\n      }\n    }\n  }\n\n  get ResourceConstructor() {\n    return ResourceIdCollection\n  }\n\n  isArray() {\n    return this._array\n  }\n\n  isEmpty() {\n    return this._nullable\n  }\n\n  has(resource) {\n    return this._avl.has(resource)\n  }\n\n  keys() {\n    return this._avl.keys()\n  }\n\n  values() {\n    return this._avl.values()\n  }\n\n  entries() {\n    const entries = []\n\n    this._avl.forEach(node => {\n      entries.push([\n        node.key,\n        node.data\n      ])\n    })\n\n    return entries\n  }\n\n  count() {\n    return this.keys().length\n  }\n\n  add(id, value = id) {\n    this._avl.insert(id, value)\n\n    return this.count()\n  }\n\n  update(resource) {\n    if(this.has(resource)) {\n      this.add(resource)\n      return true\n    }\n\n    return false\n  }\n}\n\nexport default ResourceIdCollection\n","import ResourceIdCollection from './id'\nimport ResourceObject from '../resource'\nimport posttransform from '../transform/post'\n\nfunction _include(resource) {\n  const included = resource.included()\n\n  if (included) {\n    if (!this._included) {\n      this._included = {}\n    }\n\n    for (let type in included) {\n      if (!(type in this._included)) {\n        this._included[type] = ResourceIdCollection()\n      }\n\n      included.values().forEach(resource => this._included[type].add(resource))\n    }\n  }\n\n  return included\n}\n\nclass ResourceCollection extends ResourceIdCollection {\n  constructor() {\n    super()\n\n    this._included = null\n  }\n\n  get ResourceConstructor() {\n    return ResourceObject\n  }\n\n  add(resource) {\n    const count = ResourceIdCollection.prototype.apply(this, arguments)\n\n    _include.call(this, resource)\n\n    return count\n  }\n\n  toJSON() {\n    const toJSONed = this.values().map(resource => resource.toJSON())\n    return posttransform(toJSONed)\n  }\n}\n\nexport default ResourceCollection\n","import merge from 'lodash/merge'\nimport isEmpty from 'lodash/isEmpty'\nimport isNil from 'lodash/isNil'\n\nimport {\n  ResourceObject,\n  ResourceIdentifier\n} from './resource'\nimport ResourceCollection from './collection'\n\nimport PromiseTree from './promiseTree'\nimport TypeStore from './typeStore'\n\nfunction createQueryIds(type, data) {\n  if (data._s instanceof ResourceIdentifier) {\n    const resource = data._s\n\n    if (resource._i && resource._i[type]) {\n      return resource._i[type]._s.id\n    }\n  } else if (data._s instanceof ResourceCollection) {\n    let ids = new Set()\n\n    const values = data._s.values()\n\n    values.forEach(resource => {\n      if (resource._i && resource._i[type]) {\n        const _ids = resource._i[type]._s.id\n\n        if (_ids) {\n          if (Array.isArray(_ids)) {\n            _ids.forEach(id => ids.add(id))\n          } else {\n            ids.add(_ids)\n          }\n        }\n      }\n    })\n\n    ids = Array.from(ids.values())\n\n    if (isEmpty(ids)) {\n      return null\n    }\n\n    return ids\n  }\n}\n\nexport default async function fetch(queries, action, type, options, ...args) {\n  const typeStore = new TypeStore(ResourceObject, [], {})\n\n  async function _fetch(type, typeOptions) {\n    const query = queries[type][action]\n    const prefetched = await query(typeOptions)\n\n    const result = {\n      data: new TypeStore(ResourceObject, prefetched.data, typeOptions)\n    }\n\n    return result\n  }\n\n  const typeOptions = options[type]\n\n  const tree = new PromiseTree()\n\n  const includedTree = tree.set([type], async (opts, next) => {\n    const result = await _fetch(type, typeOptions)\n\n    if ('include' in typeOptions) {\n      if (!('included' in result)) {\n        await next(result.data)\n      }\n    }\n\n    return result\n  })\n\n  typeOptions.include.map(path => {\n    return includedTree.parse(path)\n  }).forEach(path => {\n    path.forEach((type, index, path) => {\n      return includedTree.set(path.slice(0, index + 1), async (data, next) => {\n        if (data) {\n          const ids = createQueryIds(type, data)\n\n          if (isNil(ids) || isEmpty(ids)) {\n            return null\n          }\n\n          let typeOptions = Object.assign({}, options[type])\n\n          typeOptions.filter = merge({}, typeOptions.filter, {\n            id: ids\n          })\n\n          const result = await _fetch(type, typeOptions)\n\n          if (!('included' in result)) {\n            await next(result.data)\n          }\n\n          return result\n        }\n      })\n    })\n  })\n\n  const r = await tree.resolve(null)\n\n  console.dir(r.map(([path, r]) => {\n    if (r) {\n      const {\n        data\n      } = r\n      return [path, data ? data.toJSON() : data]\n    } else {\n      return [path, r]\n    }\n  }), {\n    depth: Infinity\n  })\n\n  return r\n}\n","export default function compare(a, b) {\n  if (!a) {\n    if (!b) {\n      return 0\n    }\n\n    return -1\n  } else if (!b) {\n    return 1\n  }\n\n  for (let key of ['type', 'id']) {\n    if (a[key] < b[key]) {\n      return -1\n    }\n\n    if (a[key] > b[key]) {\n      return 1\n    }\n  }\n\n  return 0\n}\n","import get from 'lodash/get'\nimport set from 'lodash/set'\n\nimport fetch from './fetch'\n\nimport * as Resource from './resource'\n\nclass JsonApi {\n  constructor(options = {}) {\n    this.options = {}\n    this._connected = {}\n  }\n\n  connect(type, fetch) {\n    const keys = [\n      'create',\n      'read',\n      'update',\n      'delete'\n    ]\n    const _createTypeError = () => new TypeError('Invalid argument type for fetch')\n    const _fetch = {}\n    if (fetch instanceof Function) {\n      keys.forEach(key => _fetch[key] = fetch)\n    } else if (fetch instanceof Object) {\n      keys.forEach(key => {\n        if (!_fetch[key] instanceof Function) {\n          throw _createTypeError()\n        }\n        _fetch[key] = fetch[key]\n      })\n    } else {\n      throw _createTypeError()\n    }\n\n    this._connected[type] = _fetch\n  }\n\n  fetch(action, type, options, ...args) {\n    return fetch(this._connected, action, type, options, ...args)\n  }\n}\n\nexport default JsonApi\n","import Node from '@alexeimyshkouski/node-tree'\nimport once from 'lodash/once'\n\nfunction _resolveChildren(data, node, rootNode) {\n  node.forEach(child => {\n    child.data.path = [...node.path, child.key]\n  })\n  return Promise.all(node.children().map(node => _resolve(data, node, rootNode)))\n}\n\nfunction _resolve(data, node, rootNode = node) {\n  if (rootNode.rejected) {\n    throw rootNode.rejected\n  }\n\n  if (node === rootNode) {\n    return _resolveChildren(data, node, rootNode).then(() => rootNode.value())\n  }\n\n  return Promise.resolve(data)\n    .then(data => {\n      const next = once(data => _resolveChildren(data, node, rootNode))\n      return node.value().call(null, data, next)\n    })\n    .then(data => {\n      node.resolved = data\n      rootNode.value().push([node.path, data])\n      return data\n    })\n    .catch(error => {\n      node.rejected = rootNode.rejected = error\n      throw error\n    })\n}\n\nclass PromiseTree extends Node {\n  constructor(options = {}) {\n    super(options)\n\n    this.set([])\n    this.path = []\n  }\n\n  resolve(data) {\n    return _resolve(data, this)\n  }\n}\n\nexport default PromiseTree\n","import pretransform from '../transform/pre'\nimport pick from 'lodash/pick'\n\nexport default class ResourceId {\n  constructor(source, options) {\n    Object.defineProperties(this, {\n      '_source': {\n        value: source\n      },\n      _resource: {\n        value: pretransform(source, options)\n      }\n    })\n  }\n\n  get id() {\n    return this._resource && this._resource.id\n  }\n\n  get type() {\n    return this._resource && this._resource.type\n  }\n\n  toJSON(options) {\n    return pick(this._resource, ['type', 'id', 'meta'])\n  }\n}\n","import ResourceID from './id'\nimport ResourceIdCollection from '../collection/id'\nimport fields from '../transform/fields'\n\nfunction include(source, options) {\n  if (typeof options === 'object') {\n    const included = {}\n\n    for (let type in options) {\n      included[type] = ResourceIdCollection.from(source, options[type])\n    }\n\n    return included\n  }\n\n  return null\n}\n\nclass ResourceObject extends ResourceID {\n  constructor(source, options = {}) {\n    super()\n\n    this._attrs = fields(this._r, options.fields)\n    this._included = include(this.source, options.relationships)\n  }\n\n  set(...args) {\n    return set(this._attrs, ...args)\n  }\n\n  get(...args) {\n    return get(this._attrs, ...args)\n  }\n\n  included() {\n    return this._included\n  }\n\n  toJSON() {\n    const resource = pick(this._r, RESOURCE_PROPS)\n\n    if (this._i) {\n      resource.relationships = this.included()\n    }\n\n    if (this._a) {\n      resource.attributes = this._a\n    }\n\n    return resource\n  }\n}\n\nexport {\n  ResourceID\n}\n\nexport default ResourceObject\n","import pick from 'lodash/pick'\nimport isEmpty from 'lodash/isEmpty'\n\nexport default (data, options) => {\n  const attributes = pick(data.attributes, options)\n\n  if(!isEmpty(attributes)) {\n    data.attributes = attributes\n  }\n\n  return data\n}\n","import sort from './sort'\n\nconst posttransform = (data, options) => {\n  if(!options) {\n    return data\n  }\n\n  if('sort' in options) {\n    data = sort(data, options.sort)\n  }\n\n  // if('page' in options) {\n  //   data = paginate(data, options.page)\n  // }\n\n  return data\n}\n\nexport default posttransform\n","import get from 'lodash/get'\n\nfunction _sortByNumberOrCharCodes(vector, a, b) {\n  if (a > b) {\n    return vector\n  } else if (a < b) {\n    return -1 * vector\n  }\n\n  return 0\n}\n\nfunction _sortByKey(rule, a, b) {\n  const [key, vector] = rule\n  return _sortByNumberOrCharCodes(vector, get(a, key), get(b, key))\n}\n\nfunction _parseSortRules(options) {\n\n  return string.split(',')\n}\n\nconst applySort = (data, options) => {\n  if(typeof options === 'string') {\n    options = options.split(',')\n  }\n\n  if(!Array.isArray(options)) {\n    throw new TypeError('Sort options should be an array or string')\n  }\n\n  options = options.map(rule => {\n    if(typeof rule === 'string') {\n      rule = (rule[0] == '-') ? [rule.slice(1), -1] : [rule, 1]\n    }\n\n    if(!Array.isArray(rule)) {\n      throw new TypeError('Sort rules should be an array or string')\n    }\n\n    if(typeof rule[1] !== 'number') {\n      throw new TypeError('Sort order should be a number')\n    }\n\n    return rule\n  })\n\n  return data.sort((a, b) => {\n    if('attributes' in a && 'attributes' in b) {\n      for (let rule of options) {\n        const res = _sortByKey(rule, a.attributes, b.attributes)\n\n        if (res) {\n          return res\n        }\n      }\n    }\n\n    return 0\n  })\n}\n\nexport default applySort\n","import omit from 'lodash/omit'\nimport set from 'lodash/set'\nimport get from 'lodash/get'\n\nfunction assignAlias(data, alias, fullPath) {\n  if (typeof alias == 'string') {\n    return alias.length ? get(data, alias) : data\n  } else {\n    let obj = Array.isArray(alias) ? [] : Object.assign({}, data)\n\n    if (typeof alias == 'object') {\n      const _omitProps = []\n\n      for (let key in alias) {\n        const path = fullPath + key\n\n        let _alias = alias[key]\n\n        const aliased = assignAlias(data, _alias, path)\n\n        if (path != _alias) {\n          _omitProps.push(_alias)\n        }\n\n        set(obj, key, aliased)\n      }\n\n      if (_omitProps.length) {\n        obj = omit(obj, _omitProps)\n      }\n    }\n\n    return obj\n  }\n}\n\nexport default function(data, options) {\n  return assignAlias(data, options, '')\n}\n","import merge from 'lodash/merge'\nimport defaults from 'lodash/defaults'\nimport pick from 'lodash/pick'\nimport isObject from 'lodash/isObject'\nimport isNil from 'lodash/isNil'\n\nimport assignAlias from './alias'\nimport {\n  RESOURCE_IDENTIFIER_ESSENTIAL_PROPS\n} from '../resourceProps'\n\nfunction pretransform(data, options) {\n  if (isNil(data)) {\n    return data\n  }\n\n  const isOptionsPassed = isObject(options)\n\n  if (isOptionsPassed) {\n    if ('alias' in options) {\n      data = assignAlias(data, options.alias)\n    }\n\n    if ('defaults' in options) {\n      data = defaults({}, data, options.defaults)\n    }\n\n    if ('merge' in options) {\n      data = merge({}, data, options.merge)\n    }\n  }\n\n  if (isObject(data)) {\n    data = RESOURCE_IDENTIFIER_ESSENTIAL_PROPS.reduce((data, key) => {\n      if (isNil(data[key])) {\n        const error = new TypeError(`Cannot transform '${ key }' prop to string`)\n        error.data = data\n        error.key = key\n        throw error\n      }\n\n      data[key] += ''\n\n      return data\n    }, Object.assign({}, data))\n  }\n\n  if (isOptionsPassed) {\n    if ('links' in options) {\n      data.links = options.links(data.type, data.id)\n    }\n  }\n\n  return data\n}\n\nexport default pretransform\n","// resource identifier & object members\nexport const RESOURCE_OPTIONAL_PROPS = ['meta']\n\n// resource identifier members\nexport const RESOURCE_IDENTIFIER_ESSENTIAL_PROPS = ['type', 'id']\nexport const RESOURCE_IDENTIFIER_PROPS = [...RESOURCE_IDENTIFIER_ESSENTIAL_PROPS, ...RESOURCE_OPTIONAL_PROPS]\n\n// resource object members\nexport const RESOURCE_OBJECT_OPTIONAL_PROPS = ['attributes', 'relationships', 'links', ...RESOURCE_OPTIONAL_PROPS]\nexport const RESOURCE_PROPS = [\n  ...RESOURCE_IDENTIFIER_ESSENTIAL_PROPS,\n  ...RESOURCE_OBJECT_OPTIONAL_PROPS\n]\n","import ResourceCollection from './collection'\nimport get from 'lodash/get'\n\nclass TypeStore {\n  constructor(ResourceConstructor, source, options) {\n    if ('from' in options) {\n      source = get(source, options.from)\n    }\n\n    let single = false\n\n    if (Array.isArray(source)) {\n      this._s = ResourceCollection.from(ResourceConstructor, source, options)\n    } else {\n      single = true\n      this._s = new ResourceConstructor(source, options)\n    }\n\n    Object.defineProperty(this, 'single', {\n      value: single\n    })\n  }\n\n  toJSON(options) {\n    return this._s.toJSON(options)\n  }\n}\n\nexport default TypeStore\n","module.exports = require(\"avl\");","module.exports = require(\"babel-runtime/core-js/array/from\");","module.exports = require(\"babel-runtime/core-js/object/assign\");","module.exports = require(\"babel-runtime/core-js/object/define-properties\");","module.exports = require(\"babel-runtime/core-js/promise\");","module.exports = require(\"babel-runtime/core-js/set\");","module.exports = require(\"lodash/defaults\");","module.exports = require(\"lodash/get\");","module.exports = require(\"lodash/isEmpty\");","module.exports = require(\"lodash/isNil\");","module.exports = require(\"lodash/isObject\");","module.exports = require(\"lodash/merge\");","module.exports = require(\"lodash/omit\");","module.exports = require(\"lodash/once\");","module.exports = require(\"lodash/pick\");","module.exports = require(\"lodash/set\");"],"sourceRoot":""}