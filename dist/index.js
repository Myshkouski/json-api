module.exports=function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r.w={},r(r.s=14)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{message:e.message,path:e.dataPath,schema:e.parentSchema.$id}},e.exports=t.default},function(e,t){e.exports=[{$id:"/",$async:!0,allOf:[{anyOf:[{required:["data"]},{required:["errors"]},{required:["meta"]}],errorMessage:"A document MUST contain at least one of the following top-level members: 'data', 'errors', 'meta'"},{not:{required:["errors","data"]},errorMessage:"The members data and errors MUST NOT coexist in the same document"},{not:{allOf:[{not:{required:["data"]}},{required:["included"]}]},errorMessage:"If a document does not contain a top-level 'data' key, the 'included' member MUST NOT be present either"},{type:"object",properties:{data:{$ref:"/data"},errors:{$ref:"/errors"},meta:{$ref:"/meta"},links:{$ref:"/links"},included:{$ref:"/included"},jsonapi:{type:"object"}},additionalProperties:!1,errorMessage:{type:"A JSON object MUST be at the root of every JSON API request and response containing data",additionalProperties:"Unless otherwise noted, objects defined by this specification MUST NOT contain any additional members"}}]},{$id:"/data",oneOf:[{$ref:"/resource"},{$ref:"/included"},{type:"null"}],errorMessage:"Primary data MUST be either a single resource object, or a single resource identifier object, or null, for requests that target single resources, or an array of resource objects, or an array of resource identifier objects, or an empty array for requests that target resource collections"},{$id:"/errors",type:"array",items:{$ref:"/error"},errorMessage:{type:"Error objects MUST be returned as an array keyed by errors in the top level of a JSON API document"}},{$id:"/links",type:"object",patternProperties:{"^.*":{$ref:"/link"}},additionalProperties:!1,errorMessage:{type:"The value of each 'links' member MUST be an object"}},{$id:"/included",type:"array",items:{$ref:"/resource"}},{$id:"/resource",type:"object",properties:{id:{type:"string",errorMessage:"The values of the 'id' member MUST be strings"},type:{type:"string",errorMessage:"The values of the 'type' member MUST be strings"},meta:{$ref:"/meta"},attributes:{type:"object"},relationships:{type:"array",items:{$ref:"/resource"}},links:{$ref:"/links"}},required:["id","type"],additionalProperties:!1,errorMessage:{required:"Every resource object MUST contain an 'id' member and a 'type' member"}},{$id:"/error",type:"object"},{$id:"/meta",type:"object"},{$id:"/link",oneOf:[{type:["string"]},{type:["object"],properties:{href:{type:"string",errorMessage:"Member 'href' should be a string containing the link’s URL."},meta:{$ref:"/meta"}},additionalProperties:!1}],errorMessage:"A 'link' MUST be represented either a string containing the link’s URL, or an object which can contain the 'href' and 'meta' members"}]},function(e,t){e.exports=require("ajv-errors")},function(e,t){e.exports=require("ajv")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSchemas=t.addSchema=t.validate=void 0;var a=i(r(3)),n=i(r(2)),o=i(r(1));function i(e){return e&&e.__esModule?e:{default:e}}var s=new a.default({schemas:o.default,verbose:!0,allErrors:!0,jsonPointers:!0});(0,n.default)(s,{});t.validate=function(e,t){return s.validate(e,t)},t.addSchema=function(e){return s.addShema(schema)},t.getSchemas=function(e){var t={};for(var r in s._schemas)t[r]=s._schemas[r].schema;return t}},function(e,t){e.exports=require("lodash.defaultsdeep")},function(e,t){e.exports=require("json8-patch")},function(e,t){e.exports=require("babel-runtime/helpers/createClass")},function(e,t){e.exports=require("babel-runtime/helpers/classCallCheck")},function(e,t){e.exports=require("babel-runtime/helpers/asyncToGenerator")},function(e,t){e.exports=require("babel-runtime/regenerator")},function(e,t){e.exports=require("babel-runtime/core-js/object/assign")},function(e,t){e.exports=require("babel-runtime/core-js/object/keys")},function(e,t){e.exports=require("babel-runtime/helpers/typeof")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=h(r(13)),n=h(r(12)),o=h(r(11)),i=h(r(10)),s=h(r(9)),u=h(r(8)),c=h(r(7)),d=h(r(6)),l=h(r(5)),f=r(4),p=h(r(0));function h(e){return e&&e.__esModule?e:{default:e}}var b=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,u.default)(this,e),this.options={},"body"in t){if("object"!=(0,a.default)(t.body))throw new Error("'options.body' should be a JSON object");this.body=t.body}else this.body={};if("validatePatch"in t){if("boolean"!=typeof t.validatePatch)throw new Error("'options.validatePatch' should be 'true' or 'false'");this.options.validatePatch=t.validatePatch}else this.options.validatePatch=!1}return(0,c.default)(e,null,[{key:"validate",value:function(){var e=(0,s.default)(i.default.mark(function e(){var t,r,a=arguments;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="/",r=a.length<=0?void 0:a[0],a.length>1&&(t=a.length<=0?void 0:a[0],r=a.length<=1?void 0:a[1]),e.prev=2,e.next=5,(0,f.validate)(t,r);case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),{message:"Validation error",reasons:e.t0.errors.map(p.default)};case 11:case"end":return e.stop()}},e,this,[[2,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"patch",value:function(){var t=(0,s.default)(i.default.mark(function t(r,a){var n,s,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=void 0,t.prev=1,t.prev=2,n=d.default.apply(r,a,(0,o.default)({},u,{reversible:!0})),t.next=10;break;case 6:throw t.prev=6,t.t0=t.catch(2),t.t0.detail="Cannot apply JSON patch",t.t0;case 10:if(!u.validatePatch){t.next=20;break}return t.prev=11,t.next=14,e.validate(n.doc);case 14:t.next=20;break;case 16:throw t.prev=16,t.t1=t.catch(11),t.t1.detail="Document validation failed after patch has been applied",t.t1;case 20:t.next=28;break;case 22:throw t.prev=22,t.t2=t.catch(1),s=d.default.revert(r,n.revert).doc,t.t2.doc=s,t.t2.ops=a,t.t2;case 28:return t.abrupt("return",n);case 29:case"end":return t.stop()}},t,this,[[1,22],[2,6],[11,16]])}));return function(e,r){return t.apply(this,arguments)}}()},{key:"add",value:function(){var t=(0,s.default)(i.default.mark(function t(r,a,n,o){var s;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=[{op:"add",path:a,value:n}],t.next=3,e.patch(r,s,o);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return function(e,r,a,n){return t.apply(this,arguments)}}()},{key:"getSchemas",value:function(e){e=(0,l.default)({},e,{type:"schema",id:"$id"});var t=(0,f.getSchemas)();return(0,n.default)(t).reduce(function(r,a,n){var o={};return"index"==e.id?o.id=n:o.id=t[a][e.id],o.type=e.type,o.attributes=t[a],r.push(o),r},[])}}]),(0,c.default)(e,[{key:"validate",value:function(){var t=(0,s.default)(i.default.mark(function t(){return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.validate(this.body);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"patch",value:function(){var t=(0,s.default)(i.default.mark(function t(r){return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.patch(this.body,r,this.options);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"add",value:function(){var t=(0,s.default)(i.default.mark(function t(r,a){return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.add(this.body,r,a,this.options);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(e,r){return t.apply(this,arguments)}}()}]),e}();t.default=b,e.exports=t.default}]);
//# sourceMappingURL=index.js.map